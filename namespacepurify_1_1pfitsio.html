<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PURIFY: purify::pfitsio Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PURIFY
   </div>
   <div id="projectbrief">Next-generation radio interferometric imaging</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacepurify.html">purify</a></li><li class="navelem"><a class="el" href="namespacepurify_1_1pfitsio.html">pfitsio</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">purify::pfitsio Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">header_params</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a06beccf538c8dfa4ecc7826ed03ac6ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a06beccf538c8dfa4ecc7826ed03ac6ff">write_key</a> (fitsfile *fptr, const std::string &amp;key, const std::string &amp;value, const std::string &amp;comment, int *status)</td></tr>
<tr class="memdesc:a06beccf538c8dfa4ecc7826ed03ac6ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">write key to fits file header  <a href="namespacepurify_1_1pfitsio.html#a06beccf538c8dfa4ecc7826ed03ac6ff">More...</a><br /></td></tr>
<tr class="separator:a06beccf538c8dfa4ecc7826ed03ac6ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0866652eb43862a9e7354b25d062810f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a0866652eb43862a9e7354b25d062810f">write_key</a> (fitsfile *fptr, const std::string &amp;key, const char *value, const std::string &amp;comment, int *status)</td></tr>
<tr class="separator:a0866652eb43862a9e7354b25d062810f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8dd66c7d9d4daaa55b8d022606c1af65"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a8dd66c7d9d4daaa55b8d022606c1af65">write_history</a> (fitsfile *fptr, const std::string &amp;context, const std::string &amp;history, int *status)</td></tr>
<tr class="memdesc:a8dd66c7d9d4daaa55b8d022606c1af65"><td class="mdescLeft">&#160;</td><td class="mdescRight">write history to fits file  <a href="namespacepurify_1_1pfitsio.html#a8dd66c7d9d4daaa55b8d022606c1af65">More...</a><br /></td></tr>
<tr class="separator:a8dd66c7d9d4daaa55b8d022606c1af65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a05de3285d7ec5d5a6e43d2e5761e8b12"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a05de3285d7ec5d5a6e43d2e5761e8b12">write2d</a> (const Image&lt; t_real &gt; &amp;eigen_image, const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;header, const bool &amp;overwrite)</td></tr>
<tr class="memdesc:a05de3285d7ec5d5a6e43d2e5761e8b12"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write image to fits file.  <a href="namespacepurify_1_1pfitsio.html#a05de3285d7ec5d5a6e43d2e5761e8b12">More...</a><br /></td></tr>
<tr class="separator:a05de3285d7ec5d5a6e43d2e5761e8b12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeb2e8fe8e4e388c9846e497b4cb8382"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#aeeb2e8fe8e4e388c9846e497b4cb8382">write2d</a> (const Image&lt; t_real &gt; &amp;image, const std::string &amp;fits_name, const std::string &amp;pix_units=&quot;Jy/Beam&quot;, const bool &amp;overwrite=true)</td></tr>
<tr class="memdesc:aeeb2e8fe8e4e388c9846e497b4cb8382"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write image to fits file.  <a href="namespacepurify_1_1pfitsio.html#aeeb2e8fe8e4e388c9846e497b4cb8382">More...</a><br /></td></tr>
<tr class="separator:aeeb2e8fe8e4e388c9846e497b4cb8382"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5cc9ae3bb5b792cc11b4be74088a7754"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a5cc9ae3bb5b792cc11b4be74088a7754">write3d</a> (const std::vector&lt; Image&lt; t_real &gt;&gt; &amp;image, const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;header, const bool &amp;overwrite=true)</td></tr>
<tr class="memdesc:a5cc9ae3bb5b792cc11b4be74088a7754"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write cube to fits file using header information.  <a href="namespacepurify_1_1pfitsio.html#a5cc9ae3bb5b792cc11b4be74088a7754">More...</a><br /></td></tr>
<tr class="separator:a5cc9ae3bb5b792cc11b4be74088a7754"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2064cf1926a00a2aeeeece32959c465"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#ab2064cf1926a00a2aeeeece32959c465">write3d</a> (const std::vector&lt; Image&lt; t_real &gt;&gt; &amp;image, const std::string &amp;fits_name, const std::string &amp;pix_units=&quot;Jy/Beam&quot;, const bool &amp;overwrite=true)</td></tr>
<tr class="memdesc:ab2064cf1926a00a2aeeeece32959c465"><td class="mdescLeft">&#160;</td><td class="mdescRight">Write cube to fits file.  <a href="namespacepurify_1_1pfitsio.html#ab2064cf1926a00a2aeeeece32959c465">More...</a><br /></td></tr>
<tr class="separator:ab2064cf1926a00a2aeeeece32959c465"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a585686ddb75d2e64e0c86c4efec3fdab"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a585686ddb75d2e64e0c86c4efec3fdab"><td class="memTemplItemLeft" align="right" valign="top">std::enable_if&lt; std::is_scalar&lt; T &gt;::value, void &gt;::type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a> (fitsfile *fptr, const std::string &amp;context, const T &amp;history, int *status)</td></tr>
<tr class="separator:a585686ddb75d2e64e0c86c4efec3fdab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a86095fdf622ce509cee700e48dba2e"><td class="memTemplParams" colspan="2">template&lt;class T &gt; </td></tr>
<tr class="memitem:a0a86095fdf622ce509cee700e48dba2e"><td class="memTemplItemLeft" align="right" valign="top">std::enable_if&lt; std::is_scalar&lt; T &gt;::value, void &gt;::type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a0a86095fdf622ce509cee700e48dba2e">write_key</a> (fitsfile *fptr, const std::string &amp;key, const T &amp;value, const std::string &amp;comment, int *status)</td></tr>
<tr class="separator:a0a86095fdf622ce509cee700e48dba2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ef982bf9a3754ed78c84d69b94bb82f"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a8ef982bf9a3754ed78c84d69b94bb82f"><td class="memTemplItemLeft" align="right" valign="top">T&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a8ef982bf9a3754ed78c84d69b94bb82f">read_key</a> (fitsfile *fptr, const std::string &amp;key, int *status)</td></tr>
<tr class="memdesc:a8ef982bf9a3754ed78c84d69b94bb82f"><td class="mdescLeft">&#160;</td><td class="mdescRight">read fits key and return as tuple  <a href="namespacepurify_1_1pfitsio.html#a8ef982bf9a3754ed78c84d69b94bb82f">More...</a><br /></td></tr>
<tr class="separator:a8ef982bf9a3754ed78c84d69b94bb82f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e8e2c90dd18fd3343091b6e83213f60"><td class="memTemplParams" colspan="2">template&lt;typename DERIVED &gt; </td></tr>
<tr class="memitem:a3e8e2c90dd18fd3343091b6e83213f60"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a3e8e2c90dd18fd3343091b6e83213f60">write2d</a> (const Eigen::EigenBase&lt; DERIVED &gt; &amp;input, int nx, int ny, const std::string &amp;fits_name, const std::string &amp;pix_units=&quot;Jy/Beam&quot;, const bool &amp;overwrite=true)</td></tr>
<tr class="separator:a3e8e2c90dd18fd3343091b6e83213f60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc28fee9e31953d95f3ddf065539a58c"><td class="memTemplParams" colspan="2">template&lt;typename DERIVED &gt; </td></tr>
<tr class="memitem:abc28fee9e31953d95f3ddf065539a58c"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#abc28fee9e31953d95f3ddf065539a58c">write2d</a> (const Eigen::EigenBase&lt; DERIVED &gt; &amp;input, int nx, int ny, const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;header, const bool overwrite=true)</td></tr>
<tr class="separator:abc28fee9e31953d95f3ddf065539a58c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa5fe65315f8b330c7111d9d48f1cca"><td class="memTemplParams" colspan="2">template&lt;typename DERIVED &gt; </td></tr>
<tr class="memitem:a3aa5fe65315f8b330c7111d9d48f1cca"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a3aa5fe65315f8b330c7111d9d48f1cca">write3d</a> (const std::vector&lt; Eigen::EigenBase&lt; DERIVED &gt;&gt; &amp;input, int nx, int ny, const std::string &amp;fits_name, const std::string &amp;pix_units=&quot;Jy/Beam&quot;, const bool &amp;overwrite=true)</td></tr>
<tr class="separator:a3aa5fe65315f8b330c7111d9d48f1cca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af097e381fa7d660f76098f5666274e90"><td class="memTemplParams" colspan="2">template&lt;typename DERIVED &gt; </td></tr>
<tr class="memitem:af097e381fa7d660f76098f5666274e90"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#af097e381fa7d660f76098f5666274e90">write3d</a> (const std::vector&lt; Eigen::EigenBase&lt; DERIVED &gt;&gt; &amp;input, int nx, int ny, const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;header, const bool &amp;overwrite=true)</td></tr>
<tr class="separator:af097e381fa7d660f76098f5666274e90"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8850eb26ccec2d0956f8e27b11a15a04"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:a8850eb26ccec2d0956f8e27b11a15a04"><td class="memTemplItemLeft" align="right" valign="top">std::enable_if&lt; std::is_same&lt; t_real, typename T::Scalar &gt;::value, void &gt;::type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a8850eb26ccec2d0956f8e27b11a15a04">write3d</a> (const Eigen::EigenBase&lt; T &gt; &amp;image, const t_int rows, const t_int cols, const t_int chans, const std::string &amp;fits_name, const std::string &amp;pix_units=&quot;Jy/Beam&quot;, const bool &amp;overwrite=true)</td></tr>
<tr class="separator:a8850eb26ccec2d0956f8e27b11a15a04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac97fabc4b92258d4c306cfd486c253c0"><td class="memTemplParams" colspan="2">template&lt;typename T &gt; </td></tr>
<tr class="memitem:ac97fabc4b92258d4c306cfd486c253c0"><td class="memTemplItemLeft" align="right" valign="top">std::enable_if&lt; std::is_same&lt; t_real, typename T::Scalar &gt;::value, void &gt;::type&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#ac97fabc4b92258d4c306cfd486c253c0">write3d</a> (const Eigen::EigenBase&lt; T &gt; &amp;image, const t_int rows, const t_int cols, const t_int chans, const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;header, const bool &amp;overwrite)</td></tr>
<tr class="memdesc:ac97fabc4b92258d4c306cfd486c253c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">write 3d fits cube with header  <a href="namespacepurify_1_1pfitsio.html#ac97fabc4b92258d4c306cfd486c253c0">More...</a><br /></td></tr>
<tr class="separator:ac97fabc4b92258d4c306cfd486c253c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a323352a9113f5104bfd6e092f1196b1d"><td class="memTemplParams" colspan="2">template&lt;typename T , typename  = std::enable_if_t&lt;std::is_same_v&lt;double, typename T::Scalar&gt;&gt;&gt; </td></tr>
<tr class="memitem:a323352a9113f5104bfd6e092f1196b1d"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a323352a9113f5104bfd6e092f1196b1d">read3d</a> (const std::string &amp;fits_name, Eigen::EigenBase&lt; T &gt; &amp;output, int &amp;rows, int &amp;cols, int &amp;channels, int &amp;pols)</td></tr>
<tr class="separator:a323352a9113f5104bfd6e092f1196b1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac45a80db8e051f45372c3018fbd027d1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; Image&lt; t_complex &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#ac45a80db8e051f45372c3018fbd027d1">read3d</a> (const std::string &amp;fits_name)</td></tr>
<tr class="memdesc:ac45a80db8e051f45372c3018fbd027d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read cube from fits file.  <a href="namespacepurify_1_1pfitsio.html#ac45a80db8e051f45372c3018fbd027d1">More...</a><br /></td></tr>
<tr class="separator:ac45a80db8e051f45372c3018fbd027d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ae1f0721ea099a29b30eaed0c47c771"><td class="memItemLeft" align="right" valign="top">Image&lt; t_complex &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a2ae1f0721ea099a29b30eaed0c47c771">read2d</a> (const std::string &amp;fits_name)</td></tr>
<tr class="memdesc:a2ae1f0721ea099a29b30eaed0c47c771"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read image from fits file.  <a href="namespacepurify_1_1pfitsio.html#a2ae1f0721ea099a29b30eaed0c47c771">More...</a><br /></td></tr>
<tr class="separator:a2ae1f0721ea099a29b30eaed0c47c771"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab302818131b95815c67a68477508881d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#ab302818131b95815c67a68477508881d">read_uvfits</a> (const std::vector&lt; std::string &gt; &amp;names, const bool flag=true, const <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8">stokes</a> pol=<a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8add7536794b63bf90eccfd37f9b147d7f">stokes::I</a>)</td></tr>
<tr class="memdesc:ab302818131b95815c67a68477508881d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read uvfits files from name of vector.  <a href="namespacepurify_1_1pfitsio.html#ab302818131b95815c67a68477508881d">More...</a><br /></td></tr>
<tr class="separator:ab302818131b95815c67a68477508881d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e659096cde08d8f8f2d5f49c9f6e99e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a0e659096cde08d8f8f2d5f49c9f6e99e">read_uvfits</a> (const std::string &amp;vis_name2, const <a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> &amp;u1, const bool flag=true, const <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8">stokes</a> pol=<a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8add7536794b63bf90eccfd37f9b147d7f">stokes::I</a>)</td></tr>
<tr class="memdesc:a0e659096cde08d8f8f2d5f49c9f6e99e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Reads in combine visiblities from uvfits files.  <a href="namespacepurify_1_1pfitsio.html#a0e659096cde08d8f8f2d5f49c9f6e99e">More...</a><br /></td></tr>
<tr class="separator:a0e659096cde08d8f8f2d5f49c9f6e99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c0c4a69590d4d6e31eb99261dab097f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a4c0c4a69590d4d6e31eb99261dab097f">read_uvfits</a> (const std::string &amp;filename, const bool flag=true, const <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8">stokes</a> pol=<a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8add7536794b63bf90eccfd37f9b147d7f">stokes::I</a>)</td></tr>
<tr class="memdesc:a4c0c4a69590d4d6e31eb99261dab097f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read uvfits file.  <a href="namespacepurify_1_1pfitsio.html#a4c0c4a69590d4d6e31eb99261dab097f">More...</a><br /></td></tr>
<tr class="separator:a4c0c4a69590d4d6e31eb99261dab097f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b1e9a6eadf27865a78d93bba2f6e657"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a1b1e9a6eadf27865a78d93bba2f6e657">filter_and_combine</a> (const <a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> &amp;input, const <a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> &amp;input2, const Vector&lt; t_complex &gt; &amp;stokes_transform, const std::function&lt; bool(t_real, t_real, t_real, t_complex, t_complex, t_real, t_real, t_real, t_complex, t_complex)&gt; &amp;filter=[](const t_real, const t_real, const t_real, const t_complex vis1, const t_complex weight1, const t_real, const t_real, const t_real, const t_complex vis2, const t_complex weight2) { return(weight1.real() &gt; 0.) and(weight2.real() &gt; 0.) and(std::abs(vis1) &gt; 1e-20) and(std::abs(vis2) &gt; 1e-20) and(!std::isnan(vis1.real()) and !std::isnan(vis1.imag())) and(!std::isnan(vis2.real()) and !std::isnan(vis2.imag()));})</td></tr>
<tr class="memdesc:a1b1e9a6eadf27865a78d93bba2f6e657"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove visibilities with zero weighting.  <a href="namespacepurify_1_1pfitsio.html#a1b1e9a6eadf27865a78d93bba2f6e657">More...</a><br /></td></tr>
<tr class="separator:a1b1e9a6eadf27865a78d93bba2f6e657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6df7d3f37fabf2254762d93c9b38df"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a3f6df7d3f37fabf2254762d93c9b38df">read_polarisation_with_flagging</a> (const Vector&lt; t_real &gt; &amp;data, const Matrix&lt; t_real &gt; &amp;coords, const Vector&lt; t_real &gt; &amp;frequencies, const t_uint pol_index1, const t_uint pol_index2, const t_uint pols, const t_uint baselines, const t_uint channels, const Vector&lt; t_complex &gt; stokes_transform, const std::function&lt; bool(t_complex, t_complex, t_complex, t_complex)&gt; &amp;filter)</td></tr>
<tr class="memdesc:a3f6df7d3f37fabf2254762d93c9b38df"><td class="mdescLeft">&#160;</td><td class="mdescRight">read polarisation with flaggging  <a href="namespacepurify_1_1pfitsio.html#a3f6df7d3f37fabf2254762d93c9b38df">More...</a><br /></td></tr>
<tr class="separator:a3f6df7d3f37fabf2254762d93c9b38df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96a909089a418869696283dd65731bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#ae96a909089a418869696283dd65731bc">read_polarisation</a> (const Vector&lt; t_real &gt; &amp;data, const Matrix&lt; t_real &gt; &amp;coords, const Vector&lt; t_real &gt; &amp;frequencies, const t_uint pol_index1, const t_uint pols, const t_uint baselines, const t_uint channels)</td></tr>
<tr class="memdesc:ae96a909089a418869696283dd65731bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">read polarisation data from uvfits data  <a href="namespacepurify_1_1pfitsio.html#ae96a909089a418869696283dd65731bc">More...</a><br /></td></tr>
<tr class="separator:ae96a909089a418869696283dd65731bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1b7543288898d44307ce71175f45627"><td class="memItemLeft" align="right" valign="top">Vector&lt; t_real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#ae1b7543288898d44307ce71175f45627">read_uvfits_freq</a> (fitsfile *fptr, int *status, const int &amp;col)</td></tr>
<tr class="memdesc:ae1b7543288898d44307ce71175f45627"><td class="mdescLeft">&#160;</td><td class="mdescRight">read frequencies for each channel  <a href="namespacepurify_1_1pfitsio.html#ae1b7543288898d44307ce71175f45627">More...</a><br /></td></tr>
<tr class="separator:ae1b7543288898d44307ce71175f45627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9591bc2271af0bc9dc93f715d53eba03"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a9591bc2271af0bc9dc93f715d53eba03">read_uvfits_freq</a> (fitsfile *fptr, int *status, Vector&lt; t_real &gt; &amp;output, const int &amp;col)</td></tr>
<tr class="separator:a9591bc2271af0bc9dc93f715d53eba03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae28dabb813e077fad12fcbc1e0817911"><td class="memItemLeft" align="right" valign="top">Vector&lt; t_real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#ae28dabb813e077fad12fcbc1e0817911">read_uvfits_data</a> (fitsfile *fptr, int *status, const std::vector&lt; int &gt; &amp;naxis, const int &amp;baselines)</td></tr>
<tr class="memdesc:ae28dabb813e077fad12fcbc1e0817911"><td class="mdescLeft">&#160;</td><td class="mdescRight">read data from uvfits file  <a href="namespacepurify_1_1pfitsio.html#ae28dabb813e077fad12fcbc1e0817911">More...</a><br /></td></tr>
<tr class="separator:ae28dabb813e077fad12fcbc1e0817911"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ef62ee302ba159e99b69b057bc9a720"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a3ef62ee302ba159e99b69b057bc9a720">read_uvfits_data</a> (fitsfile *fptr, int *status, const std::vector&lt; int &gt; &amp;naxis, const int &amp;baselines, Vector&lt; t_real &gt; &amp;output)</td></tr>
<tr class="separator:a3ef62ee302ba159e99b69b057bc9a720"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf1863933bc948d5b9d6129706e6e7a5"><td class="memItemLeft" align="right" valign="top">Matrix&lt; t_real &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#aaf1863933bc948d5b9d6129706e6e7a5">read_uvfits_coords</a> (fitsfile *fptr, int *status, const int &amp;groups, const int &amp;pcount)</td></tr>
<tr class="memdesc:aaf1863933bc948d5b9d6129706e6e7a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">read coordinates from uvfits file  <a href="namespacepurify_1_1pfitsio.html#aaf1863933bc948d5b9d6129706e6e7a5">More...</a><br /></td></tr>
<tr class="separator:aaf1863933bc948d5b9d6129706e6e7a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ad9e69e80d82aaf5925b6da550e1d85"><td class="memItemLeft" align="right" valign="top">t_real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a4ad9e69e80d82aaf5925b6da550e1d85">read_value_from_data</a> (const Vector&lt; t_real &gt; &amp;data, const t_uint col, const t_uint pol, const t_uint pols, const t_uint chan, const t_uint chans, const t_uint baseline, const t_uint baselines)</td></tr>
<tr class="memdesc:a4ad9e69e80d82aaf5925b6da550e1d85"><td class="mdescLeft">&#160;</td><td class="mdescRight">read value from data  <a href="namespacepurify_1_1pfitsio.html#a4ad9e69e80d82aaf5925b6da550e1d85">More...</a><br /></td></tr>
<tr class="separator:a4ad9e69e80d82aaf5925b6da550e1d85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7c72608a0a44fc31e640b6e77be7748"><td class="memItemLeft" align="right" valign="top">t_complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">read_vis_from_data</a> (const Vector&lt; t_real &gt; &amp;data, const t_uint pol, const t_uint pols, const t_uint chan, const t_uint chans, const t_uint baseline, const t_uint baselines)</td></tr>
<tr class="memdesc:af7c72608a0a44fc31e640b6e77be7748"><td class="mdescLeft">&#160;</td><td class="mdescRight">return visibility for given baseline  <a href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">More...</a><br /></td></tr>
<tr class="separator:af7c72608a0a44fc31e640b6e77be7748"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e34256158689b24229b60876e06d174"><td class="memItemLeft" align="right" valign="top">t_complex&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">read_weight_from_data</a> (const Vector&lt; t_real &gt; &amp;data, const t_uint pol, const t_uint pols, const t_uint chan, const t_uint chans, const t_uint baseline, const t_uint baselines)</td></tr>
<tr class="memdesc:a5e34256158689b24229b60876e06d174"><td class="mdescLeft">&#160;</td><td class="mdescRight">return weight for given baseline  <a href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">More...</a><br /></td></tr>
<tr class="separator:a5e34256158689b24229b60876e06d174"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fcf6f965ed83321f2ca96b05d1d409b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a0fcf6f965ed83321f2ca96b05d1d409b">read_uvfits_coords</a> (fitsfile *fptr, int *status, const int &amp;pcount, const int &amp;groups, Matrix&lt; t_real &gt; &amp;output)</td></tr>
<tr class="separator:a0fcf6f965ed83321f2ca96b05d1d409b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c0c3a206a6bba991d2f820c7c93ff8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepurify_1_1pfitsio.html#a9c0c3a206a6bba991d2f820c7c93ff8b">read_fits_keys</a> (fitsfile *fptr, int *status)</td></tr>
<tr class="memdesc:a9c0c3a206a6bba991d2f820c7c93ff8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read uvfits keys out.  <a href="namespacepurify_1_1pfitsio.html#a9c0c3a206a6bba991d2f820c7c93ff8b">More...</a><br /></td></tr>
<tr class="separator:a9c0c3a206a6bba991d2f820c7c93ff8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a1b1e9a6eadf27865a78d93bba2f6e657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1b1e9a6eadf27865a78d93bba2f6e657">&#9670;&nbsp;</a></span>filter_and_combine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> purify::pfitsio::filter_and_combine </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> &amp;&#160;</td>
          <td class="paramname"><em>input2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; t_complex &gt; &amp;&#160;</td>
          <td class="paramname"><em>stokes_transform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; bool(t_real, t_real, t_real, t_complex, t_complex, t_real, t_real, t_real, t_complex, t_complex)&gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove visibilities with zero weighting. </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00175">175</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                                                             {</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  t_uint size = 0;</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <span class="keywordflow">if</span> (stokes_transform.size() != 2)</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;stokes transform is not the right size (!= 2).&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="keywordflow">if</span> (stokes_transform.isZero()) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;stokes transform not valid.&quot;</span>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">if</span> (input.size() != input2.size())</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Cannot apply filter to each data set, sizes do not match.&quot;</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; input.size(); i++) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (filter(input.u(i), input.v(i), input.w(i), input.vis(i), input.weights(i), input2.u(i),</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;               input2.v(i), input2.w(i), input2.vis(i), input2.weights(i))) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;      <span class="keywordflow">if</span> (std::abs(input.u(i) - input2.u(i)) &gt; 1e-6)</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;baselines don&#39;t match for filter.&quot;</span>);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;      <span class="keywordflow">if</span> (std::abs(input.v(i) - input2.v(i)) &gt; 1e-6)</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;baselines don&#39;t match for filter.&quot;</span>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      <span class="keywordflow">if</span> (std::abs(input.w(i) - input2.w(i)) &gt; 1e-6)</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;baselines don&#39;t match for filter.&quot;</span>);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      size++;</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    }</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;Applying flags: Keeping {} out of {} data points.&quot;</span>, size, input.size());</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  utilities::vis_params output(Vector&lt;t_real&gt;::Zero(size), Vector&lt;t_real&gt;::Zero(size),</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                               Vector&lt;t_real&gt;::Zero(size), Vector&lt;t_complex&gt;::Zero(size),</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                               Vector&lt;t_complex&gt;::Zero(size), input.units, input.ra, input.dec,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                               input.average_frequency);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  output.time = Vector&lt;t_real&gt;::Zero(size);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  output.baseline = Vector&lt;t_uint&gt;::Zero(size);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  output.frequencies = input.frequencies;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  t_uint count = 0;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  <span class="keywordflow">for</span> (t_uint i = 0; i &lt; input.size(); i++)</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="keywordflow">if</span> (filter(input.u(i), input.v(i), input.w(i), input.vis(i), input.weights(i), input2.u(i),</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;               input2.v(i), input2.w(i), input2.vis(i), input2.weights(i))) {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;      output.u(count) = input.u(i);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;      output.v(count) = input.v(i);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;      output.w(count) = input.w(i);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;      output.vis(count) = input.vis(i) * stokes_transform(0) + input2.vis(i) * stokes_transform(1);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      output.weights(count) = 1. / std::sqrt(1. / input.weights(i) * stokes_transform(0) +</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                             1. / input2.weights(i) * stokes_transform(1));</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;      output.baseline(count) = input.baseline(i);</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;      output.time(count) = input.time(i);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      count++;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;    }</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;}</div>
<div class="ttc" id="alogging_8h_html_a0c01897a385e812973d29bead7548584"><div class="ttname"><a href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a></div><div class="ttdeci">#define PURIFY_LOW_LOG(...)</div><div class="ttdoc">Low priority message.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00207">logging.h:207</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="uvw__utilities_8h_source.html#l00027">purify::utilities::vis_params::average_frequency</a>, <a class="el" href="uvw__utilities_8h_source.html#l00020">purify::utilities::vis_params::baseline</a>, <a class="el" href="uvw__utilities_8h_source.html#l00026">purify::utilities::vis_params::dec</a>, <a class="el" href="uvw__utilities_8h_source.html#l00021">purify::utilities::vis_params::frequencies</a>, <a class="el" href="logging_8h_source.html#l00207">PURIFY_LOW_LOG</a>, <a class="el" href="uvw__utilities_8h_source.html#l00025">purify::utilities::vis_params::ra</a>, <a class="el" href="uvw__utilities_8h_source.html#l00054">purify::utilities::vis_params::size()</a>, <a class="el" href="uvw__utilities_8h_source.html#l00019">purify::utilities::vis_params::time</a>, <a class="el" href="uvw__utilities_8h_source.html#l00016">purify::utilities::vis_params::u</a>, <a class="el" href="uvw__utilities_8h_source.html#l00024">purify::utilities::vis_params::units</a>, <a class="el" href="uvw__utilities_8h_source.html#l00017">purify::utilities::vis_params::v</a>, <a class="el" href="uvw__utilities_8h_source.html#l00022">purify::utilities::vis_params::vis</a>, <a class="el" href="uvw__utilities_8h_source.html#l00018">purify::utilities::vis_params::w</a>, and <a class="el" href="uvw__utilities_8h_source.html#l00023">purify::utilities::vis_params::weights</a>.</p>

</div>
</div>
<a id="a2ae1f0721ea099a29b30eaed0c47c771"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ae1f0721ea099a29b30eaed0c47c771">&#9670;&nbsp;</a></span>read2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Image&lt;t_complex&gt; purify::pfitsio::read2d </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read image from fits file. </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00339">339</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                                                    {</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;<span class="comment">    Reads in an image from a fits file and returns the image.</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;<span class="comment">    fits_name:: name of fits file</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160; </div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;  <span class="keyword">const</span> std::vector&lt;Image&lt;t_complex&gt;&gt; images = <a class="code" href="namespacepurify_1_1pfitsio.html#ac45a80db8e051f45372c3018fbd027d1">read3d</a>(fits_name);</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="keywordflow">return</span> images.at(0);</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_ac45a80db8e051f45372c3018fbd027d1"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#ac45a80db8e051f45372c3018fbd027d1">purify::pfitsio::read3d</a></div><div class="ttdeci">std::vector&lt; Image&lt; t_complex &gt; &gt; read3d(const std::string &amp;fits_name)</div><div class="ttdoc">Read cube from fits file.</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8h_source.html#l00325">pfitsio.h:325</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8h_source.html#l00291">read3d()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cc_source.html#l00025">main()</a>, and <a class="el" href="algo__factory_8cc_source.html#l00027">TEST_CASE()</a>.</p>

</div>
</div>
<a id="ac45a80db8e051f45372c3018fbd027d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac45a80db8e051f45372c3018fbd027d1">&#9670;&nbsp;</a></span>read3d() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;Image&lt;t_complex&gt; &gt; purify::pfitsio::read3d </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read cube from fits file. </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00325">325</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                                                               {</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  std::vector&lt;Image&lt;t_complex&gt;&gt; eigen_images;</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  Vector&lt;double&gt; image;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordtype">int</span> rows, cols, channels, pols = 1;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  read3d&lt;Vector&lt;double&gt;&gt;(fits_name, image, rows, cols, channels, pols);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; channels; i++) {</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    Vector&lt;t_complex&gt; eigen_image = Vector&lt;t_complex&gt;::Zero(rows * cols);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    eigen_image.real() = image.segment(i * rows * cols, rows * cols);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    eigen_images.push_back(Image&lt;t_complex&gt;::Map(eigen_image.data(), rows, cols));</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <span class="keywordflow">return</span> eigen_images;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a323352a9113f5104bfd6e092f1196b1d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a323352a9113f5104bfd6e092f1196b1d">&#9670;&nbsp;</a></span>read3d() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T , typename  = std::enable_if_t&lt;std::is_same_v&lt;double, typename T::Scalar&gt;&gt;&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::read3d </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::EigenBase&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>channels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>pols</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00291">291</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                      {</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;<span class="comment">     Reads in a cube from a fits file and returns the vector of images.</span></div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="comment">     fits_name:: name of fits file</span></div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;<span class="comment">   */</span></div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  fitsfile *fptr;</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;Reading fits file {}&quot;</span>, fits_name);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keywordflow">if</span> (fits_open_image(&amp;fptr, fits_name.c_str(), READONLY, &amp;status))</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error opening image &quot;</span> + fits_name);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> naxis = pfitsio::read_key&lt;int&gt;(fptr, <span class="stringliteral">&quot;NAXIS&quot;</span>, &amp;status);</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  <span class="keywordflow">if</span> (naxis &lt; 1) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Image contains zero axes.&quot;</span>);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  rows = pfitsio::read_key&lt;int&gt;(fptr, <span class="stringliteral">&quot;NAXIS1&quot;</span>, &amp;status);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  cols = (naxis &gt; 1) ? pfitsio::read_key&lt;int&gt;(fptr, <span class="stringliteral">&quot;NAXIS2&quot;</span>, &amp;status) : 1;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  channels = (naxis &gt; 2) ? pfitsio::read_key&lt;int&gt;(fptr, <span class="stringliteral">&quot;NAXIS3&quot;</span>, &amp;status) : 1;</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  pols = (naxis &gt; 3) ? pfitsio::read_key&lt;int&gt;(fptr, <span class="stringliteral">&quot;NAXIS4&quot;</span>, &amp;status) : 1;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;Axes {}&quot;</span>, naxis);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;  std::vector&lt;long&gt; fpixel(naxis, 1);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;Dimensions {}x{}x{}x{}&quot;</span>, rows, cols, channels, pols);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">if</span> (pols &gt; 1) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Too many polarisations when reading &quot;</span> + fits_name);</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;  t_real nulval = 0;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  <span class="keywordtype">int</span> anynul = 0;</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  output.derived() = Vector&lt;typename T::Scalar&gt;::Zero(rows * cols * channels * pols);</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="keywordflow">if</span> (fits_read_pix(fptr, TDOUBLE, fpixel.data(), <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(output.size()), &amp;nulval,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    output.derived().data(), &amp;anynul, &amp;status))</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error reading data from image &quot;</span> + fits_name);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <span class="keywordflow">if</span> (anynul) <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;There are bad values when reading &quot;</span> + fits_name);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordflow">if</span> (fits_close_file(fptr, &amp;status))</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem closing fits file: &quot;</span> + fits_name);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="logging_8h_source.html#l00207">PURIFY_LOW_LOG</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cc_source.html#l00025">main()</a>, and <a class="el" href="pfitsio_8h_source.html#l00339">read2d()</a>.</p>

</div>
</div>
<a id="a9c0c3a206a6bba991d2f820c7c93ff8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c0c3a206a6bba991d2f820c7c93ff8b">&#9670;&nbsp;</a></span>read_fits_keys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::read_fits_keys </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read uvfits keys out. </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00405">405</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                                 {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  std::shared_ptr&lt;char&gt; card =</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      std::shared_ptr&lt;char&gt;(<span class="keyword">new</span> <span class="keywordtype">char</span>[FLEN_CARD], [](<span class="keywordtype">char</span> *ptr) { <span class="keyword">delete</span>[] ptr; });</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;  <span class="keywordtype">int</span> nkeys;</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;  fits_get_hdrspace(fptr, &amp;nkeys, NULL, status);</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 1; ii &lt;= nkeys; ii++) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    fits_read_record(fptr, ii, card.get(), status); <span class="comment">/* read keyword */</span></div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    std::printf(<span class="stringliteral">&quot;%s\n&quot;</span>, card.get());</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;  }</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;  std::printf(<span class="stringliteral">&quot;END\n\n&quot;</span>); <span class="comment">/* terminate listing with END */</span></div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ef982bf9a3754ed78c84d69b94bb82f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ef982bf9a3754ed78c84d69b94bb82f">&#9670;&nbsp;</a></span>read_key()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">T purify::pfitsio::read_key </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read fits key and return as tuple </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00122">122</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                                              {</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  T value;</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  <span class="keywordtype">char</span> comment[FLEN_COMMENT];</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">if</span> constexpr (std::is_same_v&lt;T, std::string&gt;) {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="keywordflow">if</span> (fits_read_key(fptr, TSTRING, key.data(), value.data(), comment, status)) {</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error reading value from key &quot;</span> + key);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    }</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <span class="keywordtype">int</span> datatype = 0;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (std::is_same&lt;T, double&gt;::value)</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;      datatype = TDOUBLE;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same_v&lt;T, float&gt;)</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;      datatype = TFLOAT;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same_v&lt;T, int&gt;)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;      datatype = TINT;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same_v&lt;T, bool&gt;)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      datatype = TLOGICAL;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Key type of value not supported by PURIFY template for &quot;</span> + key);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">if</span> (fits_read_key(fptr, datatype, key.data(), &amp;value, comment, status)) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;      <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error reading value from key &quot;</span> + key);</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;  }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <span class="keywordflow">return</span> value;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae96a909089a418869696283dd65731bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae96a909089a418869696283dd65731bc">&#9670;&nbsp;</a></span>read_polarisation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> purify::pfitsio::read_polarisation </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Matrix&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>frequencies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pol_index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baselines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>channels</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read polarisation data from uvfits data </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00284">284</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                                               {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <span class="keyword">const</span> t_uint stride = channels * baselines;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  utilities::vis_params uv_data;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  uv_data.u = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  uv_data.v = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  uv_data.w = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  uv_data.time = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  uv_data.baseline = Vector&lt;t_uint&gt;::Zero(stride);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  uv_data.vis = Vector&lt;t_complex&gt;::Zero(stride);</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  uv_data.weights = Vector&lt;t_complex&gt;::Zero(stride);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keywordflow">if</span> (pol_index1 &gt;= pols) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Polarisation index out of bounds.&quot;</span>);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="comment">// reading in data</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  t_uint count = 0;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keywordflow">for</span> (t_uint <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a> = 0; <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a> &lt; channels; <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>++)</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">for</span> (t_uint b = 0; b &lt; baselines; b++) {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      uv_data.vis(count) = <a class="code" href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">read_vis_from_data</a>(data, pol_index1, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;      uv_data.weights(count) =</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;          <a class="code" href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">read_weight_from_data</a>(data, pol_index1, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;      count++;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    }</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  uv_data.average_frequency = frequencies.array().mean();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keywordflow">for</span> (t_uint i = 0; i &lt; frequencies.size(); i++) {</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    uv_data.u.segment(i * baselines, baselines) = coords.row(0) * frequencies(i);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    uv_data.v.segment(i * baselines, baselines) = -coords.row(1) * frequencies(i);</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    uv_data.w.segment(i * baselines, baselines) = coords.row(2) * frequencies(i);</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    uv_data.baseline.segment(i * baselines, baselines) = coords.row(3).cast&lt;t_uint&gt;();</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    uv_data.time.segment(i * baselines, baselines) = coords.row(4);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;  }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  uv_data.frequencies = frequencies;</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  uv_data.units = utilities::vis_units::lambda;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">return</span> uv_data;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1constant_html_a289e794ad6812bcd3de2fdcc68dfb01b"><div class="ttname"><a href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">purify::constant::c</a></div><div class="ttdeci">const t_real c</div><div class="ttdoc">speed of light in vacuum</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00060">types.h:60</a></div></div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a5e34256158689b24229b60876e06d174"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">purify::pfitsio::read_weight_from_data</a></div><div class="ttdeci">t_complex read_weight_from_data(const Vector&lt; t_real &gt; &amp;data, const t_uint pol, const t_uint pols, const t_uint chan, const t_uint chans, const t_uint baseline, const t_uint baselines)</div><div class="ttdoc">return weight for given baseline</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00388">uvfits.cc:388</a></div></div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_af7c72608a0a44fc31e640b6e77be7748"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">purify::pfitsio::read_vis_from_data</a></div><div class="ttdeci">t_complex read_vis_from_data(const Vector&lt; t_real &gt; &amp;data, const t_uint pol, const t_uint pols, const t_uint chan, const t_uint chans, const t_uint baseline, const t_uint baselines)</div><div class="ttdoc">return visibility for given baseline</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00381">uvfits.cc:381</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="uvw__utilities_8h_source.html#l00027">purify::utilities::vis_params::average_frequency</a>, <a class="el" href="uvw__utilities_8h_source.html#l00020">purify::utilities::vis_params::baseline</a>, <a class="el" href="types_8h_source.html#l00060">purify::constant::c</a>, <a class="el" href="uvw__utilities_8h_source.html#l00021">purify::utilities::vis_params::frequencies</a>, <a class="el" href="namespacepurify_1_1utilities.html#aa2af2ee7e4f1bb93a42235b9d973983da945f3fc449518a73b9f5f32868db466c">purify::utilities::lambda</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00381">read_vis_from_data()</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00388">read_weight_from_data()</a>, <a class="el" href="uvw__utilities_8h_source.html#l00019">purify::utilities::vis_params::time</a>, <a class="el" href="uvw__utilities_8h_source.html#l00016">purify::utilities::vis_params::u</a>, <a class="el" href="uvw__utilities_8h_source.html#l00024">purify::utilities::vis_params::units</a>, <a class="el" href="uvw__utilities_8h_source.html#l00017">purify::utilities::vis_params::v</a>, <a class="el" href="uvw__utilities_8h_source.html#l00022">purify::utilities::vis_params::vis</a>, <a class="el" href="uvw__utilities_8h_source.html#l00018">purify::utilities::vis_params::w</a>, and <a class="el" href="uvw__utilities_8h_source.html#l00023">purify::utilities::vis_params::weights</a>.</p>

</div>
</div>
<a id="a3f6df7d3f37fabf2254762d93c9b38df"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f6df7d3f37fabf2254762d93c9b38df">&#9670;&nbsp;</a></span>read_polarisation_with_flagging()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> purify::pfitsio::read_polarisation_with_flagging </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Matrix&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>frequencies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pol_index1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pol_index2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baselines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>channels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Vector&lt; t_complex &gt;&#160;</td>
          <td class="paramname"><em>stokes_transform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::function&lt; bool(t_complex, t_complex, t_complex, t_complex)&gt; &amp;&#160;</td>
          <td class="paramname"><em>filter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read polarisation with flaggging </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00225">225</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                                                                 {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  t_uint count = 0;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordflow">for</span> (t_uint <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a> = 0; <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a> &lt; channels; <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>++)</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">for</span> (t_uint b = 0; b &lt; baselines; b++) {</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      t_complex <span class="keyword">const</span> weight1 =</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;          <a class="code" href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">read_weight_from_data</a>(data, pol_index1, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      t_complex <span class="keyword">const</span> weight2 =</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <a class="code" href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">read_weight_from_data</a>(data, pol_index2, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      t_complex <span class="keyword">const</span> vis1 = <a class="code" href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">read_vis_from_data</a>(data, pol_index1, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      t_complex <span class="keyword">const</span> vis2 = <a class="code" href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">read_vis_from_data</a>(data, pol_index2, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (filter(vis1, weight1, vis2, weight2)) count++;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;  <span class="keyword">const</span> t_uint stride = count;</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;  utilities::vis_params uv_data;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;  uv_data.u = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;  uv_data.v = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;  uv_data.w = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  uv_data.time = Vector&lt;t_real&gt;::Zero(stride);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  uv_data.baseline = Vector&lt;t_uint&gt;::Zero(stride);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  uv_data.vis = Vector&lt;t_complex&gt;::Zero(stride);</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  uv_data.weights = Vector&lt;t_complex&gt;::Zero(stride);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  uv_data.average_frequency = frequencies.array().mean();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="keywordflow">if</span> (pol_index1 &gt;= pols) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Polarisation index out of bounds.&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="keywordflow">if</span> (pol_index2 &gt;= pols) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Polarisation index out of bounds.&quot;</span>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;Applying flags: Keeping {} out of {} data points.&quot;</span>, stride, channels * baselines);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="comment">// reading in data</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  count = 0;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <span class="keywordflow">for</span> (t_uint <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a> = 0; <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a> &lt; channels; <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>++)</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">for</span> (t_uint b = 0; b &lt; baselines; b++) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      t_complex <span class="keyword">const</span> weight1 =</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;          <a class="code" href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">read_weight_from_data</a>(data, pol_index1, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      t_complex <span class="keyword">const</span> weight2 =</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;          <a class="code" href="namespacepurify_1_1pfitsio.html#a5e34256158689b24229b60876e06d174">read_weight_from_data</a>(data, pol_index2, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      t_complex <span class="keyword">const</span> vis1 = <a class="code" href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">read_vis_from_data</a>(data, pol_index1, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      t_complex <span class="keyword">const</span> vis2 = <a class="code" href="namespacepurify_1_1pfitsio.html#af7c72608a0a44fc31e640b6e77be7748">read_vis_from_data</a>(data, pol_index2, pols, <a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>, channels, b, baselines);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="comment">// checking flags of both polarisations</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <span class="keywordflow">if</span> (filter(vis1, weight1, vis2, weight2)) {</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        uv_data.vis(count) = uv_data.vis(count) =</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            vis1 * stokes_transform(0) + vis2 * stokes_transform(1);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        uv_data.weights(count) =</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            1. / std::sqrt(1. / weight1 * stokes_transform(0) + 1. / weight2 * stokes_transform(1));</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        uv_data.u(count) = coords(0, b) * frequencies(<a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        uv_data.v(count) = -coords(1, b) * frequencies(<a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        uv_data.w(count) = coords(2, b) * frequencies(<a class="code" href="namespacepurify_1_1constant.html#a289e794ad6812bcd3de2fdcc68dfb01b">c</a>);</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        uv_data.baseline(count) = <span class="keyword">static_cast&lt;</span>t_uint<span class="keyword">&gt;</span>(coords(3, b));</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        uv_data.time(count) = coords(4, b);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        count++;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;      }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  assert(count == stride);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  uv_data.frequencies = frequencies;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  uv_data.units = utilities::vis_units::lambda;</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;All Data Read!&quot;</span>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <span class="keywordflow">return</span> uv_data;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;}</div>
<div class="ttc" id="alogging_8h_html_ad2207dcfa3c2c44fa0fccbb9d0a3b21c"><div class="ttname"><a href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a></div><div class="ttdeci">#define PURIFY_MEDIUM_LOG(...)</div><div class="ttdoc">Medium priority message.</div><div class="ttdef"><b>Definition:</b> <a href="logging_8h_source.html#l00205">logging.h:205</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="uvw__utilities_8h_source.html#l00027">purify::utilities::vis_params::average_frequency</a>, <a class="el" href="uvw__utilities_8h_source.html#l00020">purify::utilities::vis_params::baseline</a>, <a class="el" href="types_8h_source.html#l00060">purify::constant::c</a>, <a class="el" href="uvw__utilities_8h_source.html#l00021">purify::utilities::vis_params::frequencies</a>, <a class="el" href="namespacepurify_1_1utilities.html#aa2af2ee7e4f1bb93a42235b9d973983da945f3fc449518a73b9f5f32868db466c">purify::utilities::lambda</a>, <a class="el" href="logging_8h_source.html#l00207">PURIFY_LOW_LOG</a>, <a class="el" href="logging_8h_source.html#l00205">PURIFY_MEDIUM_LOG</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00381">read_vis_from_data()</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00388">read_weight_from_data()</a>, <a class="el" href="uvw__utilities_8h_source.html#l00019">purify::utilities::vis_params::time</a>, <a class="el" href="uvw__utilities_8h_source.html#l00016">purify::utilities::vis_params::u</a>, <a class="el" href="uvw__utilities_8h_source.html#l00024">purify::utilities::vis_params::units</a>, <a class="el" href="uvw__utilities_8h_source.html#l00017">purify::utilities::vis_params::v</a>, <a class="el" href="uvw__utilities_8h_source.html#l00022">purify::utilities::vis_params::vis</a>, <a class="el" href="uvw__utilities_8h_source.html#l00018">purify::utilities::vis_params::w</a>, and <a class="el" href="uvw__utilities_8h_source.html#l00023">purify::utilities::vis_params::weights</a>.</p>

<p class="reference">Referenced by <a class="el" href="purify_2uvfits_8cc_source.html#l00049">read_uvfits()</a>.</p>

</div>
</div>
<a id="a4c0c4a69590d4d6e31eb99261dab097f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c0c4a69590d4d6e31eb99261dab097f">&#9670;&nbsp;</a></span>read_uvfits() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> purify::pfitsio::read_uvfits </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8">stokes</a>&#160;</td>
          <td class="paramname"><em>pol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read uvfits file. </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00049">49</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;                                                                                              {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  fitsfile *fptr;</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <span class="keywordtype">int</span> hdupos;</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  <span class="keywordtype">int</span> baselines;</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;  <span class="keywordtype">int</span> naxes;</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordtype">int</span> pcount;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  t_real ra = 0;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  t_real dec = 0;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  std::shared_ptr&lt;char&gt; comment =</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;      std::shared_ptr&lt;char&gt;(<span class="keyword">new</span> <span class="keywordtype">char</span>[FLEN_CARD], [](<span class="keywordtype">char</span> *ptr) { <span class="keyword">delete</span>[] ptr; });</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;Reading uvfits {}&quot;</span>, filename);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;  <span class="keywordflow">if</span> (fits_open_file(&amp;fptr, filename.c_str(), READONLY, &amp;status))</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Could not open file &quot;</span> + filename);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160; </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordtype">int</span> hdutype;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  <span class="keywordflow">if</span> (fits_movabs_hdu(fptr, 1, &amp;hdutype, &amp;status)) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error changing HDU.&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  <span class="keywordflow">if</span> (hdutype != IMAGE_HDU)</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;HDU 1 not expected type &quot;</span> + std::to_string(hdutype));</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  fits_read_key(fptr, TDOUBLE, <span class="stringliteral">&quot;CRVAL5&quot;</span>, &amp;ra, comment.get(), &amp;status);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  fits_read_key(fptr, TDOUBLE, <span class="stringliteral">&quot;CRVAL6&quot;</span>, &amp;dec, comment.get(), &amp;status);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  fits_read_key(fptr, TINT, <span class="stringliteral">&quot;GCOUNT&quot;</span>, &amp;baselines, comment.get(), &amp;status);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;  fits_read_key(fptr, TINT, <span class="stringliteral">&quot;NAXIS&quot;</span>, &amp;naxes, comment.get(), &amp;status);</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  fits_read_key(fptr, TINT, <span class="stringliteral">&quot;PCOUNT&quot;</span>, &amp;pcount, comment.get(), &amp;status);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordflow">if</span> (naxes == 0) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;No axes in header... &quot;</span>);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordflow">if</span> (pcount == 0) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;No uvw or time coordinates in header... &quot;</span>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  t_uint total = 1;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  std::vector&lt;int&gt; naxis(naxes, 0);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <span class="comment">// filling up axis sizes</span></div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; naxes; i++) {</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <span class="keywordtype">int</span> n;</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    std::string key = <span class="stringliteral">&quot;NAXIS&quot;</span> + std::to_string(i + 1);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    fits_read_key(fptr, TINT, key.c_str(), &amp;n, comment.get(), &amp;status);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;    naxis[i] = n;</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;NAXIS {} Size: {}&quot;</span>, i, n);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    total *= n;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  }</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  <span class="keyword">const</span> t_uint channels = naxis.at(3);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  <span class="keyword">const</span> t_uint pols = naxis.at(2);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keyword">const</span> t_uint ifs = naxis.at(4);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keyword">const</span> t_uint pointings_num = naxis.at(5);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;RA: {} deg, Dec.: {} deg&quot;</span>, ra, dec);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;Pointings: {}&quot;</span>, pointings_num);</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;IFs: {}&quot;</span>, ifs);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;Baselines: {}&quot;</span>, baselines);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;Channels: {}&quot;</span>, channels);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;Polarisations: {}&quot;</span>, pols);</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      <span class="stringliteral">&quot;Purify currently assumes uvfits files are in XX YY XY YX format. Also will only read Stokes &quot;</span></div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      <span class="stringliteral">&quot;I for now.&quot;</span>);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="logging_8h.html#ad2207dcfa3c2c44fa0fccbb9d0a3b21c">PURIFY_MEDIUM_LOG</a>(<span class="stringliteral">&quot;Total data per baseline: {}&quot;</span>, total);</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (pointings_num &gt; 1) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;More than one pointing is not supported.&quot;</span>);</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keywordflow">if</span> (ifs &gt; 1) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;More than one IF is not supported.&quot;</span>);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;Reading Data...&quot;</span>);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160; </div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">const</span> Matrix&lt;t_real&gt; coords = <a class="code" href="namespacepurify_1_1pfitsio.html#a0fcf6f965ed83321f2ca96b05d1d409b">read_uvfits_coords</a>(fptr, &amp;status, baselines, pcount);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160; </div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="comment">//  (real, imag, weight, pol, frequency) is the order</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">const</span> Vector&lt;t_real&gt; data = <a class="code" href="namespacepurify_1_1pfitsio.html#a3ef62ee302ba159e99b69b057bc9a720">read_uvfits_data</a>(fptr, &amp;status, naxis, baselines);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keyword">const</span> Vector&lt;t_real&gt; frequencies = <a class="code" href="namespacepurify_1_1pfitsio.html#a9591bc2271af0bc9dc93f715d53eba03">read_uvfits_freq</a>(fptr, &amp;status, 4);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <span class="keywordflow">if</span> (frequencies.size() != channels)</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Number of frequencies doesn&#39;t match number of channels. &quot;</span> +</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                             std::to_string(frequencies.size()) + <span class="stringliteral">&quot;!=&quot;</span> + std::to_string(channels));</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keywordtype">int</span> pol_index1;</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <span class="keywordtype">int</span> pol_index2;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  Vector&lt;t_complex&gt; stokes_transform = Vector&lt;t_complex&gt;::Zero(2);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">switch</span> (pol) {</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="keywordflow">case</span> stokes::I:</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    pol_index1 = 0;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    pol_index2 = 1;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    stokes_transform(0) = 1. / 2;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;    stokes_transform(1) = 1. / 2;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  <span class="keywordflow">case</span> stokes::Q:</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Polarisation not supported for reading uvfits.&quot;</span>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    pol_index1 = 0;</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    pol_index2 = 1;</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    stokes_transform(0) = 1. / 2;</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    stokes_transform(1) = -1. / 2;</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">case</span> stokes::U:</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Polarisation not supported for reading uvfits.&quot;</span>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    pol_index1 = 0;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    pol_index2 = 1;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    stokes_transform(0) = 1. / 2 * t_complex(0, -1);</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    stokes_transform(1) = 1. / 2 * t_complex(0, -1);</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keywordflow">case</span> stokes::V:</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Polarisation not supported for reading uvfits.&quot;</span>);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    pol_index1 = 0;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    pol_index2 = 1;</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    stokes_transform(0) = 1. / 2 * t_complex(0, -1);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    stokes_transform(1) = -1. / 2 * t_complex(0, -1);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Polarisation not supported for reading uvfits.&quot;</span>);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    pol_index1 = 0;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    pol_index2 = 1;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    stokes_transform(0) = 1. / 2;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    stokes_transform(1) = 1. / 2;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;  }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  fits_close_file(fptr, &amp;status);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <span class="keywordflow">if</span> (status) { <span class="comment">/* print any error messages */</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    fits_report_error(stderr, status);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Error reading fits file...&quot;</span>);</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;  <span class="keyword">auto</span> uv_data = <a class="code" href="namespacepurify_1_1pfitsio.html#a3f6df7d3f37fabf2254762d93c9b38df">read_polarisation_with_flagging</a>(</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      data, coords, frequencies, pol_index1, pol_index2, pols, baselines, channels,</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      stokes_transform,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      [flag](<span class="keyword">const</span> t_complex vis1, <span class="keyword">const</span> t_complex weight1, <span class="keyword">const</span> t_complex vis2,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;             <span class="keyword">const</span> t_complex weight2) {</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        <span class="keywordflow">if</span> (flag)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;          <span class="keywordflow">return</span> (weight1.real() &gt; 0.) and (weight2.real() &gt; 0.) and (std::abs(vis1) &gt; 1e-20) and</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                 (std::abs(vis2) &gt; 1e-20) and</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                 (!std::isnan(vis1.real()) and !std::isnan(vis1.imag())) and</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                 (!std::isnan(vis2.real()) and !std::isnan(vis2.imag()));</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      });</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  uv_data.<a class="code" href="structpurify_1_1utilities_1_1vis__params.html#a1f99c60f1d0691ecbf12cff5c6b99056">ra</a> = ra;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;  uv_data.dec = dec;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">return</span> uv_data;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a0fcf6f965ed83321f2ca96b05d1d409b"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a0fcf6f965ed83321f2ca96b05d1d409b">purify::pfitsio::read_uvfits_coords</a></div><div class="ttdeci">void read_uvfits_coords(fitsfile *fptr, int *status, const int &amp;pcount, const int &amp;groups, Matrix&lt; t_real &gt; &amp;output)</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00394">uvfits.cc:394</a></div></div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a3ef62ee302ba159e99b69b057bc9a720"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a3ef62ee302ba159e99b69b057bc9a720">purify::pfitsio::read_uvfits_data</a></div><div class="ttdeci">void read_uvfits_data(fitsfile *fptr, int *status, const std::vector&lt; int &gt; &amp;naxis, const int &amp;baselines, Vector&lt; t_real &gt; &amp;output)</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00353">uvfits.cc:353</a></div></div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a3f6df7d3f37fabf2254762d93c9b38df"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a3f6df7d3f37fabf2254762d93c9b38df">purify::pfitsio::read_polarisation_with_flagging</a></div><div class="ttdeci">utilities::vis_params read_polarisation_with_flagging(const Vector&lt; t_real &gt; &amp;data, const Matrix&lt; t_real &gt; &amp;coords, const Vector&lt; t_real &gt; &amp;frequencies, const t_uint pol_index1, const t_uint pol_index2, const t_uint pols, const t_uint baselines, const t_uint channels, const Vector&lt; t_complex &gt; stokes_transform, const std::function&lt; bool(t_complex, t_complex, t_complex, t_complex)&gt; &amp;filter)</div><div class="ttdoc">read polarisation with flaggging</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00225">uvfits.cc:225</a></div></div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a9591bc2271af0bc9dc93f715d53eba03"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a9591bc2271af0bc9dc93f715d53eba03">purify::pfitsio::read_uvfits_freq</a></div><div class="ttdeci">void read_uvfits_freq(fitsfile *fptr, int *status, Vector&lt; t_real &gt; &amp;output, const int &amp;col)</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00326">uvfits.cc:326</a></div></div>
<div class="ttc" id="astructpurify_1_1utilities_1_1vis__params_html_a1f99c60f1d0691ecbf12cff5c6b99056"><div class="ttname"><a href="structpurify_1_1utilities_1_1vis__params.html#a1f99c60f1d0691ecbf12cff5c6b99056">purify::utilities::vis_params::ra</a></div><div class="ttdeci">t_real ra</div><div class="ttdef"><b>Definition:</b> <a href="uvw__utilities_8h_source.html#l00025">uvw_utilities.h:25</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8add7536794b63bf90eccfd37f9b147d7f">purify::I</a>, <a class="el" href="logging_8h_source.html#l00207">PURIFY_LOW_LOG</a>, <a class="el" href="logging_8h_source.html#l00205">PURIFY_MEDIUM_LOG</a>, <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8af09564c9ca56850d4cd6b3319e541aee">purify::Q</a>, <a class="el" href="uvw__utilities_8h_source.html#l00025">purify::utilities::vis_params::ra</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00225">read_polarisation_with_flagging()</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00367">read_uvfits_coords()</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00346">read_uvfits_data()</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00320">read_uvfits_freq()</a>, <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8a4c614360da93c0a041b22e537de151eb">purify::U</a>, and <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8a5206560a306a2e085a437fd258eb57ce">purify::V</a>.</p>

</div>
</div>
<a id="a0e659096cde08d8f8f2d5f49c9f6e99e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0e659096cde08d8f8f2d5f49c9f6e99e">&#9670;&nbsp;</a></span>read_uvfits() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> purify::pfitsio::read_uvfits </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>vis_name2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> &amp;&#160;</td>
          <td class="paramname"><em>uv1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8">stokes</a>&#160;</td>
          <td class="paramname"><em>pol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Reads in combine visiblities from uvfits files. </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00020">20</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;                                                                     {</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  utilities::vis_params uv;</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacepurify_1_1distribute.html#a0bf24e0d0fb613140687838e4546ab2aa40b63143a987ddcf3aa69fb2ac32a3bd">w_term</a> = not uv1.w.isZero(0);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keyword">const</span> <span class="keyword">auto</span> uv2 = <a class="code" href="namespacepurify_1_1pfitsio.html#a4c0c4a69590d4d6e31eb99261dab097f">read_uvfits</a>(vis_name2, flag, pol);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">if</span> (std::abs(uv1.ra - uv2.ra) &gt; 1e-6)</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(vis_name2 + <span class="stringliteral">&quot;: wrong RA in pointing.&quot;</span>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;  <span class="keywordflow">if</span> (std::abs(uv1.dec - uv2.dec) &gt; 1e-6)</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(vis_name2 + <span class="stringliteral">&quot;: wrong DEC in pointing.&quot;</span>);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;  uv.ra = uv1.ra;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;  uv.dec = uv1.dec;</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  uv.u = Vector&lt;t_real&gt;::Zero(uv1.size() + uv2.size());</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  uv.v = Vector&lt;t_real&gt;::Zero(uv1.size() + uv2.size());</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;  uv.w = Vector&lt;t_real&gt;::Zero(uv1.size() + uv2.size());</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;  uv.vis = Vector&lt;t_complex&gt;::Zero(uv1.size() + uv2.size());</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  uv.weights = Vector&lt;t_complex&gt;::Zero(uv1.size() + uv2.size());</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  uv.u.segment(0, uv1.size()) = uv1.u;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;  uv.v.segment(0, uv1.size()) = uv1.v;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;  uv.w.segment(0, uv1.size()) = uv1.w;</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  uv.vis.segment(0, uv1.size()) = uv1.vis;</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;  uv.weights.segment(0, uv1.size()) = uv1.weights;</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  uv.u.segment(uv1.size(), uv2.size()) = uv2.u;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  uv.v.segment(uv1.size(), uv2.size()) = uv2.v;</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  uv.w.segment(uv1.size(), uv2.size()) = uv2.w;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  uv.vis.segment(uv1.size(), uv2.size()) = uv2.vis;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  uv.weights.segment(uv1.size(), uv2.size()) = uv2.weights;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="keywordflow">return</span> uv;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1distribute_html_a0bf24e0d0fb613140687838e4546ab2aa40b63143a987ddcf3aa69fb2ac32a3bd"><div class="ttname"><a href="namespacepurify_1_1distribute.html#a0bf24e0d0fb613140687838e4546ab2aa40b63143a987ddcf3aa69fb2ac32a3bd">purify::distribute::plan::w_term</a></div><div class="ttdeci">@ w_term</div></div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a4c0c4a69590d4d6e31eb99261dab097f"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a4c0c4a69590d4d6e31eb99261dab097f">purify::pfitsio::read_uvfits</a></div><div class="ttdeci">utilities::vis_params read_uvfits(const std::string &amp;filename, const bool flag, const stokes pol)</div><div class="ttdoc">Read uvfits file.</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00049">uvfits.cc:49</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="uvw__utilities_8h_source.html#l00026">purify::utilities::vis_params::dec</a>, <a class="el" href="uvw__utilities_8h_source.html#l00025">purify::utilities::vis_params::ra</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00012">read_uvfits()</a>, <a class="el" href="uvw__utilities_8h_source.html#l00054">purify::utilities::vis_params::size()</a>, <a class="el" href="uvw__utilities_8h_source.html#l00016">purify::utilities::vis_params::u</a>, <a class="el" href="uvw__utilities_8h_source.html#l00017">purify::utilities::vis_params::v</a>, <a class="el" href="uvw__utilities_8h_source.html#l00022">purify::utilities::vis_params::vis</a>, <a class="el" href="uvw__utilities_8h_source.html#l00018">purify::utilities::vis_params::w</a>, and <a class="el" href="uvw__utilities_8h_source.html#l00023">purify::utilities::vis_params::weights</a>.</p>

</div>
</div>
<a id="ab302818131b95815c67a68477508881d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab302818131b95815c67a68477508881d">&#9670;&nbsp;</a></span>read_uvfits() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structpurify_1_1utilities_1_1vis__params.html">utilities::vis_params</a> purify::pfitsio::read_uvfits </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::string &gt; &amp;&#160;</td>
          <td class="paramname"><em>names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespacepurify.html#a97d23bf901331999e4ef365e403ba8b8">stokes</a>&#160;</td>
          <td class="paramname"><em>pol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read uvfits files from name of vector. </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00012">12</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                                                    {</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;  utilities::vis_params output = <a class="code" href="namespacepurify_1_1pfitsio.html#a4c0c4a69590d4d6e31eb99261dab097f">read_uvfits</a>(names.at(0), flag, pol);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">if</span> (names.size() == 1) <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt; names.size(); i++) output = <a class="code" href="namespacepurify_1_1pfitsio.html#a4c0c4a69590d4d6e31eb99261dab097f">read_uvfits</a>(names.at(i), output);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;  <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="padmm__real__data_8cc_source.html#l00147">main()</a>, <a class="el" href="purify_2read__measurements_8cc_source.html#l00021">purify::read_measurements::read_measurements()</a>, <a class="el" href="purify_2uvfits_8cc_source.html#l00020">read_uvfits()</a>, and <a class="el" href="tests_2uvfits_8cc_source.html#l00013">TEST_CASE()</a>.</p>

</div>
</div>
<a id="aaf1863933bc948d5b9d6129706e6e7a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf1863933bc948d5b9d6129706e6e7a5">&#9670;&nbsp;</a></span>read_uvfits_coords() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Matrix&lt; t_real &gt; purify::pfitsio::read_uvfits_coords </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>pcount</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read coordinates from uvfits file </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00367">367</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                                                     {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  Matrix&lt;t_real&gt; output;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a0fcf6f965ed83321f2ca96b05d1d409b">read_uvfits_coords</a>(fptr, status, pcount, groups, output);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="purify_2uvfits_8cc_source.html#l00049">read_uvfits()</a>.</p>

</div>
</div>
<a id="a0fcf6f965ed83321f2ca96b05d1d409b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fcf6f965ed83321f2ca96b05d1d409b">&#9670;&nbsp;</a></span>read_uvfits_coords() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::read_uvfits_coords </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>pcount</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>groups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Matrix&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00394">394</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                                                {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  output = Matrix&lt;t_real&gt;::Zero(pcount, groups);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;  <span class="keywordtype">int</span> nulval = 0;</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="keywordtype">int</span> anynul;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="comment">// reading in parameters per baseline</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; groups; i++)</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    fits_read_col(fptr, TDOUBLE, 1, 1 + i, 1, pcount, &amp;nulval, output.col(i).data(), &amp;anynul,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                  status);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae28dabb813e077fad12fcbc1e0817911"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae28dabb813e077fad12fcbc1e0817911">&#9670;&nbsp;</a></span>read_uvfits_data() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; t_real &gt; purify::pfitsio::read_uvfits_data </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>naxis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>baselines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read data from uvfits file </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00346">346</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                                                      {</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  Vector&lt;t_real&gt; output;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a3ef62ee302ba159e99b69b057bc9a720">read_uvfits_data</a>(fptr, status, naxis, baselines, output);</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="purify_2uvfits_8cc_source.html#l00049">read_uvfits()</a>.</p>

</div>
</div>
<a id="a3ef62ee302ba159e99b69b057bc9a720"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ef62ee302ba159e99b69b057bc9a720">&#9670;&nbsp;</a></span>read_uvfits_data() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::read_uvfits_data </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>naxis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>baselines</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00353">353</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                                                                    {</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="keywordtype">long</span> nelements = 1;</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 2; i &lt; naxis.size(); i++) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    nelements *= <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(naxis.at(i));</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  <span class="keywordflow">if</span> (nelements == 0) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Zero number of elements.&quot;</span>);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  output = Vector&lt;t_real&gt;::Zero(naxis.at(1) * nelements * baselines);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordtype">int</span> nulval = 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  <span class="keywordtype">int</span> anynul = 0;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  fits_read_col(fptr, TDOUBLE, 2, 1, 1, <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(output.size()), &amp;nulval, output.data(),</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                &amp;anynul, status);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae1b7543288898d44307ce71175f45627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1b7543288898d44307ce71175f45627">&#9670;&nbsp;</a></span>read_uvfits_freq() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Vector&lt; t_real &gt; purify::pfitsio::read_uvfits_freq </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read frequencies for each channel </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00320">320</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                                             {</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  Vector&lt;t_real&gt; output;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a9591bc2271af0bc9dc93f715d53eba03">read_uvfits_freq</a>(fptr, status, output, col);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">return</span> output;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="purify_2uvfits_8cc_source.html#l00049">read_uvfits()</a>.</p>

</div>
</div>
<a id="a9591bc2271af0bc9dc93f715d53eba03"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9591bc2271af0bc9dc93f715d53eba03">&#9670;&nbsp;</a></span>read_uvfits_freq() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::read_uvfits_freq </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int &amp;&#160;</td>
          <td class="paramname"><em>col</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00326">326</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                                                                           {</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  t_real cfreq;</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  t_real dfreq;</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  <span class="keywordtype">int</span> crpix;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordtype">int</span> nfreq;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  std::shared_ptr&lt;char&gt; comment =</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;      std::shared_ptr&lt;char&gt;(<span class="keyword">new</span> <span class="keywordtype">char</span>[FLEN_CARD], [](<span class="keywordtype">char</span> *ptr) { <span class="keyword">delete</span>[] ptr; });</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  std::string key = <span class="stringliteral">&quot;CRVAL&quot;</span> + std::to_string(col);</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  fits_read_key(fptr, TDOUBLE, key.c_str(), &amp;cfreq, comment.get(), status);</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  key = <span class="stringliteral">&quot;CDELT&quot;</span> + std::to_string(col);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;  fits_read_key(fptr, TDOUBLE, key.c_str(), &amp;dfreq, comment.get(), status);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  key = <span class="stringliteral">&quot;CRPIX&quot;</span> + std::to_string(col);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  fits_read_key(fptr, TINT, key.c_str(), &amp;crpix, comment.get(), status);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  key = <span class="stringliteral">&quot;NAXIS&quot;</span> + std::to_string(col);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  fits_read_key(fptr, TINT, key.c_str(), &amp;nfreq, comment.get(), status);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span> (nfreq == 0) <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Wrong number of channels read from header.&quot;</span>);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  output = Vector&lt;t_real&gt;::Zero(nfreq);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; output.size(); i++) output(i) = (i - nfreq * 0.5) * dfreq + cfreq;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ad9e69e80d82aaf5925b6da550e1d85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ad9e69e80d82aaf5925b6da550e1d85">&#9670;&nbsp;</a></span>read_value_from_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">t_real purify::pfitsio::read_value_from_data </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>chans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baselines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>read value from data </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00374">374</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                                           {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">const</span> t_uint index = col + 3 * (pol + pols * (chan + chans * baseline));</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;  <span class="keywordflow">return</span> data(index);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="purify_2uvfits_8cc_source.html#l00381">read_vis_from_data()</a>, and <a class="el" href="purify_2uvfits_8cc_source.html#l00388">read_weight_from_data()</a>.</p>

</div>
</div>
<a id="af7c72608a0a44fc31e640b6e77be7748"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7c72608a0a44fc31e640b6e77be7748">&#9670;&nbsp;</a></span>read_vis_from_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">t_complex purify::pfitsio::read_vis_from_data </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>chans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baselines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return visibility for given baseline </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00381">381</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                                     {</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keywordflow">return</span> t_complex(<a class="code" href="namespacepurify_1_1pfitsio.html#a4ad9e69e80d82aaf5925b6da550e1d85">read_value_from_data</a>(data, 0, pol, pols, chan, chans, baseline, baselines),</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                   <a class="code" href="namespacepurify_1_1pfitsio.html#a4ad9e69e80d82aaf5925b6da550e1d85">read_value_from_data</a>(data, 1, pol, pols, chan, chans, baseline, baselines));</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a4ad9e69e80d82aaf5925b6da550e1d85"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a4ad9e69e80d82aaf5925b6da550e1d85">purify::pfitsio::read_value_from_data</a></div><div class="ttdeci">t_real read_value_from_data(const Vector&lt; t_real &gt; &amp;data, const t_uint col, const t_uint pol, const t_uint pols, const t_uint chan, const t_uint chans, const t_uint baseline, const t_uint baselines)</div><div class="ttdoc">read value from data</div><div class="ttdef"><b>Definition:</b> <a href="purify_2uvfits_8cc_source.html#l00374">uvfits.cc:374</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="purify_2uvfits_8cc_source.html#l00374">read_value_from_data()</a>.</p>

<p class="reference">Referenced by <a class="el" href="purify_2uvfits_8cc_source.html#l00284">read_polarisation()</a>, and <a class="el" href="purify_2uvfits_8cc_source.html#l00225">read_polarisation_with_flagging()</a>.</p>

</div>
</div>
<a id="a5e34256158689b24229b60876e06d174"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5e34256158689b24229b60876e06d174">&#9670;&nbsp;</a></span>read_weight_from_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">t_complex purify::pfitsio::read_weight_from_data </td>
          <td>(</td>
          <td class="paramtype">const Vector&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>pols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>chan</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>chans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baseline</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_uint&#160;</td>
          <td class="paramname"><em>baselines</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return weight for given baseline </p>

<p class="definition">Definition at line <a class="el" href="purify_2uvfits_8cc_source.html#l00388">388</a> of file <a class="el" href="purify_2uvfits_8cc_source.html">uvfits.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                                                        {</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;  <span class="keywordflow">return</span> t_complex(<a class="code" href="namespacepurify_1_1pfitsio.html#a4ad9e69e80d82aaf5925b6da550e1d85">read_value_from_data</a>(data, 2, pol, pols, chan, chans, baseline, baselines), 0);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="purify_2uvfits_8cc_source.html#l00374">read_value_from_data()</a>.</p>

<p class="reference">Referenced by <a class="el" href="purify_2uvfits_8cc_source.html#l00284">read_polarisation()</a>, and <a class="el" href="purify_2uvfits_8cc_source.html#l00225">read_polarisation_with_flagging()</a>.</p>

</div>
</div>
<a id="abc28fee9e31953d95f3ddf065539a58c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc28fee9e31953d95f3ddf065539a58c">&#9670;&nbsp;</a></span>write2d() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DERIVED &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write2d </td>
          <td>(</td>
          <td class="paramtype">const Eigen::EigenBase&lt; DERIVED &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00165">165</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                                              {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;  Image&lt;t_real&gt; <span class="keyword">const</span> data = input.derived().real().template cast&lt;t_real&gt;();</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#abc28fee9e31953d95f3ddf065539a58c">write2d</a>(Image&lt;t_real&gt;::Map(data.data(), nx, ny), header, overwrite);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_abc28fee9e31953d95f3ddf065539a58c"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#abc28fee9e31953d95f3ddf065539a58c">purify::pfitsio::write2d</a></div><div class="ttdeci">void write2d(const Eigen::EigenBase&lt; DERIVED &gt; &amp;input, int nx, int ny, const pfitsio::header_params &amp;header, const bool overwrite=true)</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8h_source.html#l00165">pfitsio.h:165</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8cc_source.html#l00030">write2d()</a>.</p>

</div>
</div>
<a id="a3e8e2c90dd18fd3343091b6e83213f60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e8e2c90dd18fd3343091b6e83213f60">&#9670;&nbsp;</a></span>write2d() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DERIVED &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write2d </td>
          <td>(</td>
          <td class="paramtype">const Eigen::EigenBase&lt; DERIVED &gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pix_units</em> = <code>&quot;Jy/Beam&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00159">159</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                                                                   {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;  Image&lt;t_real&gt; <span class="keyword">const</span> data = input.derived().real().template cast&lt;t_real&gt;();</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#abc28fee9e31953d95f3ddf065539a58c">write2d</a>(Image&lt;t_real&gt;::Map(data.data(), nx, ny), fits_name, pix_units, overwrite);</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8cc_source.html#l00030">write2d()</a>.</p>

</div>
</div>
<a id="a05de3285d7ec5d5a6e43d2e5761e8b12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05de3285d7ec5d5a6e43d2e5761e8b12">&#9670;&nbsp;</a></span>write2d() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write2d </td>
          <td>(</td>
          <td class="paramtype">const Image&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>eigen_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write image to fits file. </p>
<p>Write image to fits file using header information. </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8cc_source.html#l00030">30</a> of file <a class="el" href="pfitsio_8cc_source.html">pfitsio.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                                    {</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">    Writes an image to a fits file.</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">    image:: image data, a 2d Image.</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">        header:: structure containing header information</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">        overwrite:: if true, overwrites old fits file with same name</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160; </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#ab2064cf1926a00a2aeeeece32959c465">write3d</a>(std::vector&lt;Image&lt;t_real&gt;&gt;(1, eigen_image), header, overwrite);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_ab2064cf1926a00a2aeeeece32959c465"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#ab2064cf1926a00a2aeeeece32959c465">purify::pfitsio::write3d</a></div><div class="ttdeci">void write3d(const std::vector&lt; Image&lt; t_real &gt;&gt; &amp;eigen_images, const std::string &amp;fits_name, const std::string &amp;pix_units, const bool &amp;overwrite)</div><div class="ttdoc">Write cube to fits file.</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8cc_source.html#l00077">pfitsio.cc:77</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8cc_source.html#l00063">write3d()</a>.</p>

<p class="reference">Referenced by <a class="el" href="update__factory_8h_source.html#l00020">purify::factory::add_updater()</a>, <a class="el" href="main_8cc_source.html#l00025">main()</a>, <a class="el" href="padmm__random__coverage_8cc_source.html#l00026">padmm()</a>, <a class="el" href="padmm__mpi__real__data_8cc_source.html#l00052">padmm_factory()</a>, and <a class="el" href="pfitsio_8cc_source.html#l00044">write2d()</a>.</p>

</div>
</div>
<a id="aeeb2e8fe8e4e388c9846e497b4cb8382"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeeb2e8fe8e4e388c9846e497b4cb8382">&#9670;&nbsp;</a></span>write2d() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write2d </td>
          <td>(</td>
          <td class="paramtype">const Image&lt; t_real &gt; &amp;&#160;</td>
          <td class="paramname"><em>eigen_image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pix_units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write image to fits file. </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8cc_source.html#l00044">44</a> of file <a class="el" href="pfitsio_8cc_source.html">pfitsio.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;                                                                {</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;<span class="comment">    Writes an image to a fits file.</span></div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;<span class="comment">    image:: image data, a 2d Image.</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;<span class="comment">    fits_name:: string containing the file name of the fits file.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;<span class="comment">    pix_units:: units of flux</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">    ra:: centre pixel coordinate in ra</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;<span class="comment">    dec:: centre pixel coordinate in dec</span></div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  pfitsio::header_params header;</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  header.fits_name = fits_name;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;  header.pix_units = pix_units;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#aeeb2e8fe8e4e388c9846e497b4cb8382">write2d</a>(eigen_image, header, overwrite);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_aeeb2e8fe8e4e388c9846e497b4cb8382"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#aeeb2e8fe8e4e388c9846e497b4cb8382">purify::pfitsio::write2d</a></div><div class="ttdeci">void write2d(const Image&lt; t_real &gt; &amp;eigen_image, const std::string &amp;fits_name, const std::string &amp;pix_units, const bool &amp;overwrite)</div><div class="ttdoc">Write image to fits file.</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8cc_source.html#l00044">pfitsio.cc:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8h_source.html#l00015">purify::pfitsio::header_params::fits_name</a>, <a class="el" href="pfitsio_8h_source.html#l00023">purify::pfitsio::header_params::pix_units</a>, and <a class="el" href="pfitsio_8cc_source.html#l00030">write2d()</a>.</p>

</div>
</div>
<a id="ac97fabc4b92258d4c306cfd486c253c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac97fabc4b92258d4c306cfd486c253c0">&#9670;&nbsp;</a></span>write3d() <span class="overload">[1/6]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt;std::is_same&lt;t_real, typename T::Scalar&gt;::value, void&gt;::type purify::pfitsio::write3d </td>
          <td>(</td>
          <td class="paramtype">const Eigen::EigenBase&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_int&#160;</td>
          <td class="paramname"><em>rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_int&#160;</td>
          <td class="paramname"><em>cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_int&#160;</td>
          <td class="paramname"><em>chans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write 3d fits cube with header </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00214">214</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                                               {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;<span class="comment">     Writes an image to a fits file.</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;<span class="comment">     image:: image data, a 2d Image.</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;<span class="comment">     header:: structure containing header information</span></div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;<span class="comment">     overwrite:: if true, overwrites old fits file with same name</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;<span class="comment">  */</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;  <span class="keywordflow">if</span> (image.size() != rows * cols * chans)</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;image or cube size does not match dimensions.&quot;</span>);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  <a class="code" href="logging_8h.html#a0c01897a385e812973d29bead7548584">PURIFY_LOW_LOG</a>(<span class="stringliteral">&quot;Writing fits file {}&quot;</span>, header.fits_name);</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;  <span class="keywordflow">if</span> (overwrite == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    remove(header.fits_name.c_str());</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;  }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  fitsfile *fptr;</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;  <span class="keywordtype">int</span> status = 0;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  std::vector&lt;long&gt; naxes = {<span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(rows), <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(cols),</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                             <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(chans), 1};</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;  std::vector&lt;long&gt; fpixel = {1, 1, 1, 1};</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keywordflow">if</span> (fits_create_file(&amp;fptr, header.fits_name.c_str(), &amp;status))</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem creating fits file:&quot;</span> + header.fits_name);</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;  <span class="keywordflow">if</span> (fits_create_img(fptr, DOUBLE_IMG, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(naxes.size()), naxes.data(), &amp;status))</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem creating HDU for image in fits file:&quot;</span> + header.fits_name);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;  <span class="keywordflow">if</span> (fits_write_pix(fptr, TDOUBLE, fpixel.data(), <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(image.size()),</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                     <span class="keyword">const_cast&lt;</span>t_real *<span class="keyword">&gt;</span>(image.derived().data()), &amp;status))</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem writing image in fits file:&quot;</span> + header.fits_name);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;<span class="preprocessor">#define PURIFY_MACRO(KEY, VALUE, COMMENT) write_key(fptr, KEY, VALUE, COMMENT, &amp;status);</span></div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;  <span class="comment">// Writing to fits header</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;BUNIT&quot;</span>, header.pix_units, <span class="stringliteral">&quot;&quot;</span>);                  <span class="comment">// units</span></div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;NAXIS&quot;</span>, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(naxes.size()), <span class="stringliteral">&quot;&quot;</span>);  <span class="comment">// number of axes</span></div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;NAXIS1&quot;</span>, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(naxes.at(0)), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;NAXIS2&quot;</span>, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(naxes.at(1)), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;NAXIS3&quot;</span>, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(naxes.at(2)), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;NAXIS4&quot;</span>, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(naxes.at(3)), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRPIX1&quot;</span>, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(std::floor(naxes.at(0) / 2)) + 1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRPIX2&quot;</span>, <span class="keyword">static_cast&lt;</span>t_int<span class="keyword">&gt;</span>(std::floor(naxes.at(1) / 2)) + 1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRPIX3&quot;</span>, 1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRPIX4&quot;</span>, 1, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRVAL1&quot;</span>, <span class="keyword">static_cast&lt;</span>t_real<span class="keyword">&gt;</span>(header.ra * 180. / <a class="code" href="namespacepurify_1_1constant.html#aa35bce2e736d0453c6005cbc06f1dbe7">purify::constant::pi</a>), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRVAL2&quot;</span>, <span class="keyword">static_cast&lt;</span>t_real<span class="keyword">&gt;</span>(header.dec * 180. / <a class="code" href="namespacepurify_1_1constant.html#aa35bce2e736d0453c6005cbc06f1dbe7">purify::constant::pi</a>), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRVAL3&quot;</span>, <span class="keyword">static_cast&lt;</span>t_real<span class="keyword">&gt;</span>(header.mean_frequency * 1.), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CRVAL4&quot;</span>, <span class="keyword">static_cast&lt;</span>t_real<span class="keyword">&gt;</span>(1), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CTYPE1&quot;</span>, <span class="stringliteral">&quot;RA--SIN&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CTYPE2&quot;</span>, <span class="stringliteral">&quot;DEC--SIN&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CTYPE3&quot;</span>, <span class="stringliteral">&quot;FREQ&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CTYPE4&quot;</span>, <span class="stringliteral">&quot;STOKES&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CDELT1&quot;</span>, <span class="keyword">static_cast&lt;</span>t_real<span class="keyword">&gt;</span>(-header.cell_x / 3600.), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CDELT2&quot;</span>, <span class="keyword">static_cast&lt;</span>t_real<span class="keyword">&gt;</span>(header.cell_y / 3600.), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CDELT3&quot;</span>, <span class="keyword">static_cast&lt;</span>t_real<span class="keyword">&gt;</span>(header.channel_width * 1.), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;CDELT4&quot;</span>, 1., <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;BTYPE&quot;</span>, <span class="stringliteral">&quot;intensity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  <a class="code" href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a>(<span class="stringliteral">&quot;EQUINOX&quot;</span>, 2000, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="preprocessor">#undef PURIFY_MACRO</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, <span class="stringliteral">&quot;SOFTWARE&quot;</span>, <span class="stringliteral">&quot;Purify&quot;</span>, &amp;status);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, <span class="stringliteral">&quot;PURIFY-NITERS&quot;</span>, header.niters, &amp;status);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  <span class="keywordflow">if</span> (header.hasconverged) {</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, <span class="stringliteral">&quot;PURIFY-CONVERGED&quot;</span>, <span class="stringliteral">&quot;True&quot;</span>, &amp;status);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;    <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, <span class="stringliteral">&quot;PURIFY-CONVERGED&quot;</span>, <span class="stringliteral">&quot;False&quot;</span>, &amp;status);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, <span class="stringliteral">&quot;PURIFY-RELATIVEVARIATION&quot;</span>, header.relative_variation, &amp;status);</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, <span class="stringliteral">&quot;PURIFY-RESIDUALCONVERGENCE&quot;</span>, header.residual_convergence, &amp;status);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, <span class="stringliteral">&quot;PURIFY-EPSILON&quot;</span>, header.epsilon, &amp;status);</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keywordflow">if</span> (fits_write_date(fptr, &amp;status))</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem writing date in fits file:&quot;</span> + header.fits_name);</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;  <span class="keywordflow">if</span> (fits_close_file(fptr, &amp;status))</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem closing fits file:&quot;</span> + header.fits_name);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1constant_html_aa35bce2e736d0453c6005cbc06f1dbe7"><div class="ttname"><a href="namespacepurify_1_1constant.html#aa35bce2e736d0453c6005cbc06f1dbe7">purify::constant::pi</a></div><div class="ttdeci">const t_real pi</div><div class="ttdoc">mathematical constant</div><div class="ttdef"><b>Definition:</b> <a href="types_8h_source.html#l00058">types.h:58</a></div></div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a585686ddb75d2e64e0c86c4efec3fdab"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">purify::pfitsio::write_history</a></div><div class="ttdeci">std::enable_if&lt; std::is_scalar&lt; T &gt;::value, void &gt;::type write_history(fitsfile *fptr, const std::string &amp;context, const T &amp;history, int *status)</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8h_source.html#l00088">pfitsio.h:88</a></div></div>
<div class="ttc" id="apfitsio_8h_html_ae5e7423e6f677807cacaaf36ad9141b3"><div class="ttname"><a href="pfitsio_8h.html#ae5e7423e6f677807cacaaf36ad9141b3">PURIFY_MACRO</a></div><div class="ttdeci">#define PURIFY_MACRO(VAR, H2)</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8h_source.html#l00062">pfitsio.h:62</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8h_source.html#l00017">purify::pfitsio::header_params::cell_x</a>, <a class="el" href="pfitsio_8h_source.html#l00018">purify::pfitsio::header_params::cell_y</a>, <a class="el" href="pfitsio_8h_source.html#l00025">purify::pfitsio::header_params::channel_width</a>, <a class="el" href="pfitsio_8h_source.html#l00020">purify::pfitsio::header_params::dec</a>, <a class="el" href="pfitsio_8h_source.html#l00031">purify::pfitsio::header_params::epsilon</a>, <a class="el" href="pfitsio_8h_source.html#l00015">purify::pfitsio::header_params::fits_name</a>, <a class="el" href="pfitsio_8h_source.html#l00028">purify::pfitsio::header_params::hasconverged</a>, <a class="el" href="pfitsio_8h_source.html#l00016">purify::pfitsio::header_params::mean_frequency</a>, <a class="el" href="pfitsio_8h_source.html#l00027">purify::pfitsio::header_params::niters</a>, <a class="el" href="types_8h_source.html#l00058">purify::constant::pi</a>, <a class="el" href="pfitsio_8h_source.html#l00023">purify::pfitsio::header_params::pix_units</a>, <a class="el" href="logging_8h_source.html#l00207">PURIFY_LOW_LOG</a>, <a class="el" href="pfitsio_8h_source.html#l00062">PURIFY_MACRO</a>, <a class="el" href="pfitsio_8h_source.html#l00019">purify::pfitsio::header_params::ra</a>, <a class="el" href="pfitsio_8h_source.html#l00029">purify::pfitsio::header_params::relative_variation</a>, <a class="el" href="pfitsio_8h_source.html#l00030">purify::pfitsio::header_params::residual_convergence</a>, and <a class="el" href="pfitsio_8cc_source.html#l00022">write_history()</a>.</p>

</div>
</div>
<a id="a8850eb26ccec2d0956f8e27b11a15a04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8850eb26ccec2d0956f8e27b11a15a04">&#9670;&nbsp;</a></span>write3d() <span class="overload">[2/6]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt;std::is_same&lt;t_real, typename T::Scalar&gt;::value, void&gt;::type purify::pfitsio::write3d </td>
          <td>(</td>
          <td class="paramtype">const Eigen::EigenBase&lt; T &gt; &amp;&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_int&#160;</td>
          <td class="paramname"><em>rows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_int&#160;</td>
          <td class="paramname"><em>cols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const t_int&#160;</td>
          <td class="paramname"><em>chans</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pix_units</em> = <code>&quot;Jy/Beam&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00202">202</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                                  {</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  pfitsio::header_params header;</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  header.fits_name = fits_name;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  header.pix_units = pix_units;</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  write3d&lt;T&gt;(image, rows, cols, chans, header, overwrite);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8h_source.html#l00015">purify::pfitsio::header_params::fits_name</a>, and <a class="el" href="pfitsio_8h_source.html#l00023">purify::pfitsio::header_params::pix_units</a>.</p>

</div>
</div>
<a id="af097e381fa7d660f76098f5666274e90"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af097e381fa7d660f76098f5666274e90">&#9670;&nbsp;</a></span>write3d() <span class="overload">[3/6]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DERIVED &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write3d </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Eigen::EigenBase&lt; DERIVED &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00191">191</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                                                                               {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  std::vector&lt;Image&lt;t_real&gt;&gt; images;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; input.size(); i++) {</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    Image&lt;t_real&gt; <span class="keyword">const</span> data = input.derived().real().template cast&lt;t_real&gt;();</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    images.push_back(Image&lt;t_real&gt;::Map(data.data(), nx, ny));</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#ac97fabc4b92258d4c306cfd486c253c0">write3d</a>(images, header, overwrite);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_ac97fabc4b92258d4c306cfd486c253c0"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#ac97fabc4b92258d4c306cfd486c253c0">purify::pfitsio::write3d</a></div><div class="ttdeci">std::enable_if&lt; std::is_same&lt; t_real, typename T::Scalar &gt;::value, void &gt;::type write3d(const Eigen::EigenBase&lt; T &gt; &amp;image, const t_int rows, const t_int cols, const t_int chans, const pfitsio::header_params &amp;header, const bool &amp;overwrite)</div><div class="ttdoc">write 3d fits cube with header</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8h_source.html#l00214">pfitsio.h:214</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8cc_source.html#l00063">write3d()</a>.</p>

</div>
</div>
<a id="a3aa5fe65315f8b330c7111d9d48f1cca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa5fe65315f8b330c7111d9d48f1cca">&#9670;&nbsp;</a></span>write3d() <span class="overload">[4/6]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename DERIVED &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write3d </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Eigen::EigenBase&lt; DERIVED &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ny</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pix_units</em> = <code>&quot;Jy/Beam&quot;</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em> = <code>true</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00180">180</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                                           {</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  std::vector&lt;Image&lt;t_real&gt;&gt; images;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; input.size(); i++) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    Image&lt;t_real&gt; <span class="keyword">const</span> data = input.derived().real().template cast&lt;t_real&gt;();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    images.push_back(Image&lt;t_real&gt;::Map(data.data(), nx, ny));</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;  }</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#ac97fabc4b92258d4c306cfd486c253c0">write3d</a>(images, fits_name, pix_units, overwrite);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8cc_source.html#l00063">write3d()</a>.</p>

</div>
</div>
<a id="a5cc9ae3bb5b792cc11b4be74088a7754"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5cc9ae3bb5b792cc11b4be74088a7754">&#9670;&nbsp;</a></span>write3d() <span class="overload">[5/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write3d </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Image&lt; t_real &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>eigen_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="structpurify_1_1pfitsio_1_1header__params.html">pfitsio::header_params</a> &amp;&#160;</td>
          <td class="paramname"><em>header</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write cube to fits file using header information. </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8cc_source.html#l00063">63</a> of file <a class="el" href="pfitsio_8cc_source.html">pfitsio.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                    {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;  std::vector&lt;long&gt; naxes = {<span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(eigen_images.at(0).rows()),</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;                             <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(eigen_images.at(0).cols()),</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                             <span class="keyword">static_cast&lt;</span><span class="keywordtype">long</span><span class="keyword">&gt;</span>(eigen_images.size()), 1};</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  std::vector&lt;long&gt; fpixel = {1, 1, 1, 1};</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  Vector&lt;t_real&gt; image = Vector&lt;t_real&gt;::Zero(naxes.at(0) * naxes.at(1) * naxes.at(2));</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; eigen_images.size(); i++)</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    image.segment(i * naxes.at(0) * naxes.at(1), naxes.at(0) * naxes.at(1)) =</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        Vector&lt;t_real&gt;::Map(eigen_images.at(i).data(), naxes.at(0) * naxes.at(1));</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  write3d&lt;Vector&lt;t_real&gt;&gt;(image, naxes.at(0), naxes.at(1), naxes.at(2), header, overwrite);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="pfitsio_8cc_source.html#l00030">write2d()</a>, and <a class="el" href="pfitsio_8cc_source.html#l00077">write3d()</a>.</p>

</div>
</div>
<a id="ab2064cf1926a00a2aeeeece32959c465"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2064cf1926a00a2aeeeece32959c465">&#9670;&nbsp;</a></span>write3d() <span class="overload">[6/6]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write3d </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; Image&lt; t_real &gt;&gt; &amp;&#160;</td>
          <td class="paramname"><em>eigen_images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>fits_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>pix_units</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>overwrite</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Write cube to fits file. </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8cc_source.html#l00077">77</a> of file <a class="el" href="pfitsio_8cc_source.html">pfitsio.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                                                                {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <span class="comment">/*</span></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">     Writes a vector of images to a fits file.</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">     image:: image data, a 3d Image.</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">     fits_name:: string containing the file name of the fits file.</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">     pix_units:: units of flux</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment">     ra:: centre pixel coordinate in ra</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">     dec:: centre pixel coordinate in dec</span></div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">*/</span></div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;  pfitsio::header_params header;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  header.fits_name = fits_name;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  header.pix_units = pix_units;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#ab2064cf1926a00a2aeeeece32959c465">write3d</a>(eigen_images, header, overwrite);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8h_source.html#l00015">purify::pfitsio::header_params::fits_name</a>, <a class="el" href="pfitsio_8h_source.html#l00023">purify::pfitsio::header_params::pix_units</a>, and <a class="el" href="pfitsio_8cc_source.html#l00063">write3d()</a>.</p>

</div>
</div>
<a id="a8dd66c7d9d4daaa55b8d022606c1af65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8dd66c7d9d4daaa55b8d022606c1af65">&#9670;&nbsp;</a></span>write_history() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write_history </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>history</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write history to fits file </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8cc_source.html#l00022">22</a> of file <a class="el" href="pfitsio_8cc_source.html">pfitsio.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                                {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;  <span class="keyword">const</span> std::string entry = context + <span class="stringliteral">&quot;: &quot;</span> + history;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;  <span class="keywordflow">if</span> (fits_write_history(fptr, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(entry.c_str()), status))</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem writing comments in fits file&quot;</span>);</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="pfitsio_8h_source.html#l00214">write3d()</a>, and <a class="el" href="pfitsio_8h_source.html#l00088">write_history()</a>.</p>

</div>
</div>
<a id="a585686ddb75d2e64e0c86c4efec3fdab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a585686ddb75d2e64e0c86c4efec3fdab">&#9670;&nbsp;</a></span>write_history() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt;std::is_scalar&lt;T&gt;::value, void&gt;::type purify::pfitsio::write_history </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>history</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00088">88</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                                                             {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  T value = history;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a585686ddb75d2e64e0c86c4efec3fdab">write_history</a>(fptr, context, std::to_string(value), status);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8cc_source.html#l00022">write_history()</a>.</p>

</div>
</div>
<a id="a0866652eb43862a9e7354b25d062810f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0866652eb43862a9e7354b25d062810f">&#9670;&nbsp;</a></span>write_key() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write_key </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8cc_source.html#l00017">17</a> of file <a class="el" href="pfitsio_8cc_source.html">pfitsio.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                                                      {</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  <a class="code" href="namespacepurify_1_1pfitsio.html#a0866652eb43862a9e7354b25d062810f">write_key</a>(fptr, key, std::string(value), comment, status);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;}</div>
<div class="ttc" id="anamespacepurify_1_1pfitsio_html_a0866652eb43862a9e7354b25d062810f"><div class="ttname"><a href="namespacepurify_1_1pfitsio.html#a0866652eb43862a9e7354b25d062810f">purify::pfitsio::write_key</a></div><div class="ttdeci">void write_key(fitsfile *fptr, const std::string &amp;key, const char *value, const std::string &amp;comment, int *status)</div><div class="ttdef"><b>Definition:</b> <a href="pfitsio_8cc_source.html#l00017">pfitsio.cc:17</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="pfitsio_8cc_source.html#l00008">write_key()</a>.</p>

</div>
</div>
<a id="a06beccf538c8dfa4ecc7826ed03ac6ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06beccf538c8dfa4ecc7826ed03ac6ff">&#9670;&nbsp;</a></span>write_key() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void purify::pfitsio::write_key </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>write key to fits file header </p>

<p class="definition">Definition at line <a class="el" href="pfitsio_8cc_source.html#l00008">8</a> of file <a class="el" href="pfitsio_8cc_source.html">pfitsio.cc</a>.</p>
<div class="fragment"><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                                                      {</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  std::string entry = value;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  <span class="keywordflow">if</span> (fits_write_key(fptr, TSTRING, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(key.c_str()),</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;                     <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(<span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(entry.c_str())),</div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                     <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(comment.c_str()), status))</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem writing key in fits file: &quot;</span> + key);</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="pfitsio_8cc_source.html#l00017">write_key()</a>.</p>

</div>
</div>
<a id="a0a86095fdf622ce509cee700e48dba2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a86095fdf622ce509cee700e48dba2e">&#9670;&nbsp;</a></span>write_key() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class T &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::enable_if&lt;std::is_scalar&lt;T&gt;::value, void&gt;::type purify::pfitsio::write_key </td>
          <td>(</td>
          <td class="paramtype">fitsfile *&#160;</td>
          <td class="paramname"><em>fptr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const T &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>comment</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="pfitsio_8h_source.html#l00095">95</a> of file <a class="el" href="pfitsio_8h_source.html">pfitsio.h</a>.</p>
<div class="fragment"><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;                                                                                     {</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keywordtype">int</span> datatype = 0;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <span class="keywordflow">if</span> (std::is_same&lt;T, double&gt;::value)</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    datatype = TDOUBLE;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same&lt;T, float&gt;::value)</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    datatype = TFLOAT;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same&lt;T, int&gt;::value)</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    datatype = TINT;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same&lt;T, t_int&gt;::value)</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    datatype = TINT;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::is_same&lt;T, bool&gt;::value)</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    datatype = TLOGICAL;</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <span class="keywordflow">else</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Key type of value not supported by PURIFY template for &quot;</span> + key);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  T entry = value;</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="keywordflow">if</span> (fits_write_key(fptr, datatype, <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(key.c_str()),</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                     <span class="keyword">reinterpret_cast&lt;</span><span class="keywordtype">void</span> *<span class="keyword">&gt;</span>(&amp;entry), <span class="keyword">const_cast&lt;</span><span class="keywordtype">char</span> *<span class="keyword">&gt;</span>(comment.c_str()), status))</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Problem writing key in fits file: &quot;</span> + key);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1
</small></address>
</body>
</html>
